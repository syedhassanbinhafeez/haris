this is a edited final branch for hassan to pull it
